.Netæ¶æ„å¸ˆä¹‹è·¯(äºŒ)

[TOC]



# 14.RabbitMQ

[Course 49-51]



æˆè¯¾ç¯å¢ƒ

1   Windows10ä¼ä¸šç‰ˆ
2   Visual Studio2019  16.5
3   AspNetCore3.1
4   RabbitMQ    3.8.3

## åˆ†å¸ƒå¼å¼‚æ­¥é˜Ÿåˆ—



<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616951417784.png" alt="1616951417784" style="zoom:80%;" />

åˆ†å¸ƒå¼ï¼šå¤šå°æœåŠ¡å™¨åˆä½œå®Œæˆä¸šåŠ¡å¤„ç†ï¼Œä¸€ä¸ªä¸šåŠ¡æµç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªæœåŠ¡å™¨å®Œæˆä¸€éƒ¨åˆ†ï¼›

å¼‚æ­¥é˜Ÿåˆ—ï¼šæœ‰ä¸€ä¸ªä¸­é—´è€…ï¼ŒæœåŠ¡å™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¸­é—´è€…



### å¤§æ•°æ®é«˜å¹¶å‘æ¶æ„å›¾

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616952717064.png" alt="1616952717064" style="zoom:80%;" />



### åŒæ­¥æ¶æ„

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616952999299.png" alt="1616952999299" style="zoom:80%;" />

**å¦‚æœç»™ä½ 500ä¸ªé¥ºå­ï¼Œä½ èƒ½åƒå®Œå—ï¼Ÿ**
å¦‚æœè¯´è®©æˆ‘ä¸€é¡¿åƒå®Œï¼Œè¿™å¯å®šæä¸å®šï¼›
å¦‚æœæ˜¯è¯´è®©æˆ‘ä¸€ä¸ªæœˆåƒå®Œï¼›å·®ä¸å¤šéƒ½èƒ½æå®š

åŒæ­¥æ¶æ„æ˜¯è¦å»ä½ é©¬ä¸Šå»å¤„ç†å®Œä¸šåŠ¡



### åˆ†å¸ƒå¼å¼‚æ­¥é˜Ÿåˆ—

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616953170515.png" alt="1616953170515" style="zoom:80%;" />

æ‹‰é•¿æ—¶é—´æ¥å¤„ç†ä¸šåŠ¡éœ€æ±‚ï¼›

ä»¥æ—¶é—´æ¢ç©ºé—´

 

#### åˆ†å¸ƒå¼å¼‚æ­¥é˜Ÿåˆ—è§£è¯»

**ä¼˜ç‚¹**ï¼š

å¼‚æ­¥å¤„ç†ï¼Œå“åº”å¿«ï¼Œå¢åŠ äº†æ•°æ®åº“ï¼ˆæœåŠ¡å™¨çš„æ‰¿è½½èƒ½åŠ›ï¼‰;
å‰Šå³°ï¼Œå°±æ˜¯æŠŠæµé‡çš„é«˜å³°åˆ†è§£åˆ°ä¸åŒçš„æ—¶é—´æ®µæ¥å¤„ç†ï¼›
è§£è€¦ï¼ˆæ‰©å±•æ€§å°±æ›´å¼ºï¼‰ï¼Œè®©UIå’Œä¸šåŠ¡ç‹¬ç«‹æ¼”åŒ–ï¼›
é«˜å¯ç”¨ï¼Œå¤„ç†å™¨å¦‚æœå‘ç”Ÿæ•…éšœäº†ï¼Œå¯¹å…¶ä»–çš„å¤„ç†å™¨æ²¡æœ‰å½±å“ï¼›



**ç¼ºé™·ï¼š**
1  å¢åŠ äº†å¤æ‚æ€§
2  å³æ—¶æ€§é™ä½äº†ï¼Œç‰ºç‰²äº†ç”¨æˆ·çš„ä½“éªŒ---é¿å…ä¸äº†ï¼Œä¸šåŠ¡ä¸Šä¹Ÿæ˜¯éœ€è¦æœ‰æ‰€ç‰ºç‰²ï¼›
3  æ›´åŠ ä¾èµ–äºå¼‚æ­¥é˜Ÿåˆ—äº†



#### å¼‚æ­¥é˜Ÿåˆ—åº”ç”¨åœºæ™¯

618æŠ¢è´­ï¼ŒæŸæŠ€æœ¯è´Ÿè´£äººè¯´éœ€è¦åšä¸ªéœ€æ±‚å˜æ›´ï¼›  UI å’Œä¸šåŠ¡é€»è¾‘å±‚å¯ä»¥ç‹¬ç«‹æ¼”åŒ–ï¼›
618ç§’æ€ï¼Œè¦æ±‚åªæœ‰åä»¶å•†å“å‚ä¸ç§’æ€ ï¼ˆè¯·æ±‚è¿›å…¥é˜Ÿåˆ—ï¼Œå–å‰10ä¸ªè¯·æ±‚ï¼Œå…¶å®ƒä½œåºŸï¼‰



## å¸¸è§å¼‚æ­¥é˜Ÿåˆ—ç»„ä»¶

ActiveMQ
RocketMQ
Kafka
RabbitMQ
Redis



## RabbitMQ

RabbitMQæ˜¯ 2007å¹´å‘å¸ƒï¼Œæ˜¯ä¸€ä¸ªåœ¨AMQP(é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®)åŸºç¡€ä¸Šå®Œæˆçš„ï¼Œç”±Erlangï¼ˆä¸“é—¨é’ˆå¯¹äºå¤§æ•°æ®é«˜å¹¶å‘çš„è¯­è¨€ï¼›ï¼‰è¯­è¨€å¼€å‘ï¼Œå¯å¤ç”¨çš„ä¼ä¸šæ¶ˆæ¯ç³»ç»Ÿï¼Œæ˜¯å½“å‰æœ€ä¸»æµçš„æ¶ˆæ¯ä¸­é—´ä»¶ä¹‹ä¸€ã€‚

- å¯é æ€§
- çµæ´»çš„è·¯ç”±
- æ¶ˆæ¯é›†ç¾¤ç®€å•
- é˜Ÿåˆ—é«˜å¯ç”¨
- å¤šç§åè®®çš„æ”¯æŒ
- æœåŠ¡å™¨ç«¯ç”¨Erlangè¯­è¨€ç¼–å†™
- ç®¡ç†ç•Œé¢
- è·Ÿè¸ªæœºåˆ¶
- æ’ä»¶æœºåˆ¶



<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616955108278.png" alt="1616955108278" style="zoom:80%;" />

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616955828420.png" alt="1616955828420" style="zoom:80%;" />



### RabbitMQè¿›ç¨‹æ¨¡å‹

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616956611776.png" alt="1616956611776" style="zoom:80%;" />![1616956680213](images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616956680213.png)

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616956611776.png" alt="1616956611776" style="zoom:80%;" />![1616956680213](images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616956680213.png)



<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616964102558.png" alt="1616964102558" style="zoom:80%;" />



### AMQPåè®® 

**å¸§ç»„ä»¶**

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616956735688.png" alt="1616956735688" style="zoom:80%;" />

1. å¸§ç±»å‹ 

   ```shell
   1  åè®®å¤´å¸§ï¼šæŒ‡å®šæ˜¯æŸç§åè®®
   2  æ–¹æ³•å¸§ï¼šæºå¸¦å‘é€ç»™rabbitmqæˆ–è€…ä»rabbitmqæ¥æ”¶åˆ°rpcè¯·æ±‚æˆ–è€…å“åº”
   3  å†…å®¹å¸§ï¼š æè¿°ä¸€æ¡æ¶ˆæ¯çš„å¤§å°å’Œå±æ€§
   4  æ¶ˆæ¯ä½“å¸§ï¼šæ¶ˆæ¯å†…å®¹
   5  å¿ƒè·³å¸§ï¼šrabbitmqå’Œå®¢æˆ·ç«¯ç›´æ¥ä¼ è¾“çš„ä¸€ä¸ªç§æ•°æ®ç±»å‹ï¼›
   ```

   

2. ä¿¡é“ç¼–å· 

3. ä»¥å­—èŠ‚ä¸ºå•ä½çš„å¸§å¤§å° 

4. å¸§æœ‰æ•ˆè½½è·payload 

5. ç»“æŸå­—èŠ‚æ ‡å¿—ï¼ˆASCIIå€¼206ï¼‰



**æ¶ˆæ¯ç»„åˆ**

å¦‚ä¸‹å›¾ï¼Œä¸€ä¸ªå®Œæ•´çš„æ¶ˆæ¯ï¼Œç”±3ç§å¸§ç»„æˆ

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616957345974.png" alt="1616957345974" style="zoom:80%;" />



### è¿è¡Œç¯å¢ƒ

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616957646795.png" alt="1616957646795" style="zoom:80%;" />



#### RabbitMQ ä¸‹è½½

 RabbitMQåŒ…
ä¸‹è½½åœ°å€ï¼š https://www.rabbitmq.com/
 ç™¾åº¦äº‘ä¸‹è½½åœ°å€ï¼šé“¾æ¥ï¼šhttps://pan.baidu.com/s/1jmlgh6osLtfkaoNi259dSw æå–ç ï¼šjskq

rabbitmq-server-windows-3.8.3.zip

https://www.rabbitmq.com/install-windows.html

Githubï¼šhttps://github.com/rabbitmq/

rabbitmq-serverå‘å¸ƒåœ°å€ï¼šhttps://github.com/rabbitmq/rabbitmq-server

>  https://github.com/rabbitmq/rabbitmq-server/releases
>
> ## RabbitMQ 3.8.14
>
> RabbitMQ `3.8.14` is a maintenance release that restores
> Erlang 22.3 compatibility for environments that use [direct reply-to](https://github.com/rabbitmq/rabbitmq-server/blob/v3.8.14/direct-reply-to.html).
>
> ### Erlang/OTP Compatibility Notes
>
> This release [requires Erlang 22.3](https://www.rabbitmq.com/which-erlang.html).
> [Erlang 23](http://blog.erlang.org/OTP-23-Highlights/) is highly recommended
> for best forward compatibility with future RabbitMQ versions.
>
> [Provisioning Latest Erlang Releases](https://www.rabbitmq.com/which-erlang.html#erlang-repositories) explains
>
> <img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616995683856.png" alt="1616995683856" style="zoom:50%;" />
>
> ä¸å…¶å¯¹åº”çš„Erlangçš„windowsç‰ˆæœ¬ä¸‹è½½åœ°å€ï¼šhttps://erlang.org/download/otp_versions_tree.html
>
> 
>
> what package repositories and tools can be used to provision a recent version of Erlang `23.x`.
>
> --------





è¿™é‡Œä¸‹è½½ [rabbitmq-server-windows-3.8.14.zip](https://github-releases.githubusercontent.com/924551/07175f00-7b7e-11eb-959e-24f9fa2f9dac?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210329%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210329T050414Z&X-Amz-Expires=300&X-Amz-Signature=a2f64eab21603e20f99f4a09921d75f5b5df13118408a1b1b396edbbee6e55e7&X-Amz-SignedHeaders=host&actor_id=35329755&key_id=0&repo_id=924551&response-content-disposition=attachment%3B filename%3Drabbitmq-server-windows-3.8.14.zip&response-content-type=application%2Foctet-stream) ç‰ˆæœ¬





ä¸Erlangçš„ç‰ˆæœ¬å¯¹åº”å…³ç³»ï¼š

https://www.rabbitmq.com/which-erlang.html



![1616994461706](images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616994461706.png)

Erlangçš„ç‰ˆæœ¬ä»“å‚¨ï¼š https://www.rabbitmq.com/which-erlang.html#erlang-repositories

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616995683856.png" alt="1616995683856" style="zoom:50%;" />

Erlangçš„windowsç‰ˆæœ¬https://erlang.org/download/otp_versions_tree.html

å…¶å®è·³è½¬åˆ°çš„ä¸‹è½½åœ°å€æ˜¯è¿™é‡Œï¼š



https://github.com/erlang/otp/releases



#### Erlangç¯å¢ƒ

å®˜ç½‘ï¼šhttps://www.erlang.org/

ä¸‹è½½åœ°å€ï¼šhttps://www.erlang.org/downloads

https://erlang.org/download/otp_versions_tree.html

https://github.com/erlang/otp/releases

 Erlangè¯­è¨€è¿è¡Œç¯å¢ƒ
ä¸‹è½½åœ°å€ï¼šhttp://www.erlang.org/downloads
 ç™¾åº¦äº‘ä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1eHRa6BZZ3UN-Cj4Of8sASA æå–ç ï¼šou3k

esl-erlang_22.1_windows_amd64.exe

Github:https://github.com/erlang/otp



æˆ‘ä»¬å¾—ä¸‹è½½ 22.3~23.x ç‰ˆæœ¬æ‰è¡Œ

https://www.erlang.org/downloads

![1616997534577](images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1616997534577.png)

[otp_win64_23.3.exe](http://erlang.org/download/otp_win64_23.3.exe)



#### Windowså®‰è£…

>å‚è€ƒèµ„æ–™ï¼š
>
>https://blog.csdn.net/fisea/article/details/111876676



##### å…ˆå®‰è£…Erlang

å®‰è£… [otp_win64_23.3.exe](http://erlang.org/download/otp_win64_23.3.exe)ï¼Œå®‰è£…ç›®å½•ï¼š`C:\Program Files\erl-23.3`

> å…¶å®ƒç‰ˆæœ¬ä¸‹è½½ï¼šhttps://www.erlang.org/downloads

ç„¶åè®¾ç½®ç¯å¢ƒå˜é‡

**ERLANG_HOME**ï¼šC:\Program Files\erl-23.3
**Path**: %ERLANG_HOME%\bin

è¿è¡Œ**CMD**:

```shell
C:\Users\wei>erl -v
Eshell V11.2  (abort with ^G)
1>
```

è¯´æ˜å®‰è£…æˆåŠŸã€‚



##### å®‰è£…RabbitMQ

> - å…¶å®ƒç‰ˆæœ¬ä¸‹è½½åœ°å€ï¼šhttps://github.com/rabbitmq/rabbitmq-server/releases
>
> - ä¸Erlangçš„ç‰ˆæœ¬å¯¹åº”å…³ç³»ï¼šhttps://www.rabbitmq.com/which-erlang.html



 è§£å‹ [rabbitmq-server-windows-3.8.14.zip](https://github-releases.githubusercontent.com/924551/07175f00-7b7e-11eb-959e-24f9fa2f9dac?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210329%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210329T050414Z&X-Amz-Expires=300&X-Amz-Signature=a2f64eab21603e20f99f4a09921d75f5b5df13118408a1b1b396edbbee6e55e7&X-Amz-SignedHeaders=host&actor_id=35329755&key_id=0&repo_id=924551&response-content-disposition=attachment%3B filename%3Drabbitmq-server-windows-3.8.14.zip&response-content-type=application%2Foctet-stream) ç‰ˆæœ¬ï¼Œç„¶åæŠŠæ–‡ä»¶å¤¹`rabbitmq_server-3.8.14`æ‹·è´åˆ°`C:\Program Files\`,å³æœ€ç»ˆç›®å½•ä¸ºï¼š

`C:\Program Files\rabbitmq_server-3.8.14`

 ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ**CMD**

```powershell
C:\WINDOWS\system32>cd C:\Program Files\rabbitmq_server-3.8.14\sbin

#å®‰è£…æœåŠ¡
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmq-service install
#å®‰è£…æˆåŠŸæç¤º
C:\Program Files\erl-23.3\erts-11.2\bin\erlsrv: Service RabbitMQ added to system.
C:\Program Files\rabbitmq_server-3.8.14\sbin>
```

> è¿™æ—¶çœ‹æ³¨å†Œè¡¨ï¼š<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1617000004830.png" alt="1617000004830" style="zoom:80%;" />
>
> 
>
> å¦‚æœä¹‹å‰å®‰è£…è¿‡ï¼Œå†å®‰è£…ï¼Œæœ‰å¯èƒ½å®‰è£…å¤±è´¥ï¼Œå¯ä»¥å…ˆå¦‚ä¸Šå›¾çš„æ³¨å†Œè¡¨`RabbitMQ`èŠ‚ç‚¹åˆ é™¤æ‰ã€‚



æ¥ç€å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡

```powershell
#æœæ°”å¯ç”¨
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmq-service enable

#æœåŠ¡å¯åŠ¨
C:\Program Files\erl-23.3\erts-11.2\bin\erlsrv: Service RabbitMQ enabled.

C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmq-service start
RabbitMQ æœåŠ¡æ­£åœ¨å¯åŠ¨ .
RabbitMQ æœåŠ¡å·²ç»å¯åŠ¨æˆåŠŸã€‚


C:\Program Files\rabbitmq_server-3.8.14\sbin>
```

æŸ¥çœ‹windowsæœåŠ¡ï¼šè¿™æ—¶å¤šå‡ºäº†ä¸€ä¸ª`RabbitMQ`çš„windowsæœåŠ¡

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1617000457654.png" alt="1617000457654" style="zoom:80%;" />

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1617000580819.png" alt="1617000580819" style="zoom:80%;" />



æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€ï¼š

```powershell
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmqctl status
Error: unable to perform an operation on node 'rabbit@DESKTOP-E6NOF0N'. Please see diagnostics information and suggestions below.

Most common reasons for this are:

 * Target node is unreachable (e.g. due to hostname resolution, TCP connection or firewall issues)
 * CLI tool fails to authenticate with the server (e.g. due to CLI tool's Erlang cookie not matching that of the server)
 * Target node is not running

In addition to the diagnostics info below:

 * See the CLI, clustering and networking guides on https://rabbitmq.com/documentation.html to learn more
 * Consult server logs on node rabbit@DESKTOP-E6NOF0N
 * If target node is configured to use long node names, don't forget to use --longnames with CLI tools

DIAGNOSTICS
===========

attempted to contact: ['rabbit@DESKTOP-E6NOF0N']

rabbit@DESKTOP-E6NOF0N:
  * connected to epmd (port 4369) on DESKTOP-E6NOF0N
  * epmd reports node 'rabbit' uses port 25672 for inter-node and CLI tool traffic
  * TCP connection succeeded but Erlang distribution failed
  * suggestion: check if the Erlang cookie identical for all server nodes and CLI tools
  * suggestion: check if all server nodes and CLI tools use consistent hostnames when addressing each other
  * suggestion: check if inter-node connections may be configured to use TLS. If so, all nodes and CLI tools must do that
   * suggestion: see the CLI, clustering and networking guides on https://rabbitmq.com/documentation.html to learn more


Current node details:
 * node name: 'rabbitmqcli-369-rabbit@DESKTOP-E6NOF0N'
 * effective user's home directory: C:\Users\wei
 * Erlang cookie hash: WdpOFxVp/R53mEM5zLwTCQ==
```



å‡ºç°ä»¥ä¸Šçš„é”™è¯¯ï¼Œæˆ–è€…å…¶å®ƒå¦‚ä¸‹å›¾æ‰€ç¤ºé”™è¯¯ï¼š

![1617001252098](images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1617001252098.png)

è§£å†³æ–¹æ³•ï¼š

å°†`C:\Users\wei\`ç›®å½•ä¸­çš„æ–‡ä»¶`.erlang.cookie`æ‹·è´åˆ°å¦‚ä¸‹ä¸¤ä¸ªç›®å½•ï¼š

```powershell
# è¿™ä¸ªæ–‡ä»¶å¤¹å·²ç»å­˜åœ¨åŒåæ–‡ä»¶.erlang.cookieï¼Œå°†å…¶è¦†ç›–
C:\Windows\System32\config\systemprofile 
C:\Program Files\rabbitmq_server-3.8.14\sbin
```

ç„¶åé‡å¯RabbitMQçš„windowsæœåŠ¡ï¼Œå†ä¸è¡Œé‡å¯ç”µè„‘

å†æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š

```shell
# æç¤ºä¸€äº›é”™è¯¯
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmqctl status
Error: this command requires the 'rabbit' app to be running on the target node. Start it with 'rabbitmqctl start_app'.
Arguments given:
        status

[1mUsage[0m

rabbitmqctl [--node <node>] [--longnames] [--quiet] status [--unit <unit>] [--timeout <timeout>]


# è‹¥è¿˜æ˜¯æç¤ºä»¥ä¸Šäº›é”™è¯¯ï¼Œå¤šå¯åŠ¨windowsæœåŠ¡å‡ æ¬¡ï¼Œç­‰å¾…ä¹…ä¸€ç‚¹
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmqctl status
Status of node rabbit@DESKTOP-E6NOF0N ...
[1mRuntime[0m

OS PID: 10516
OS: Windows
Uptime (seconds): 246
Is under maintenance?: false
RabbitMQ version: 3.8.14
Node name: rabbit@DESKTOP-E6NOF0N
Erlang configuration: Erlang/OTP 23 [erts-11.2] [source] [64-bit] [smp:8:8] [ds:8:8:10] [async-threads:1]
Erlang processes: 308 used, 1048576 limit
Scheduler run queue: 1
Cluster heartbeat timeout (net_ticktime): 60

[1mPlugins[0m

Enabled plugin file: c:/Users/wei/AppData/Roaming/RabbitMQ/enabled_plugins
Enabled plugins:


[1mData directory[0m

Node data directory: c:/Users/wei/AppData/Roaming/RabbitMQ/db/rabbit@DESKTOP-E6NOF0N-mnesia
Raft data directory: c:/Users/wei/AppData/Roaming/RabbitMQ/db/rabbit@DESKTOP-E6NOF0N-mnesia/quorum/rabbit@DESKTOP-E6NOF0N

[1mConfig files[0m


[1mLog file(s)[0m

 * c:/Users/wei/AppData/Roaming/RabbitMQ/log/rabbit@DESKTOP-E6NOF0N.log
 * c:/Users/wei/AppData/Roaming/RabbitMQ/log/rabbit@DESKTOP-E6NOF0N_upgrade.log

[1mAlarms[0m

(none)

[1mMemory[0m

Total memory used: 0.12 gb
Calculation strategy: rss
Memory high watermark setting: 0.4 of available memory, computed to: 6.8238 gb

other_proc: 0.0459 gb (36.07 %)
allocated_unused: 0.031 gb (24.36 %)
code: 0.0293 gb (23.0 %)
other_system: 0.0155 gb (12.19 %)
other_ets: 0.003 gb (2.38 %)
atom: 0.0014 gb (1.07 %)
plugins: 0.0004 gb (0.35 %)
binary: 0.0003 gb (0.27 %)
metrics: 0.0002 gb (0.17 %)
mnesia: 0.0001 gb (0.07 %)
quorum_ets: 0.0 gb (0.04 %)
msg_index: 0.0 gb (0.03 %)
connection_channels: 0.0 gb (0.0 %)
connection_other: 0.0 gb (0.0 %)
connection_readers: 0.0 gb (0.0 %)
connection_writers: 0.0 gb (0.0 %)
mgmt_db: 0.0 gb (0.0 %)
queue_procs: 0.0 gb (0.0 %)
queue_slave_procs: 0.0 gb (0.0 %)
quorum_queue_procs: 0.0 gb (0.0 %)
reserved_unallocated: 0.0 gb (0.0 %)

[1mFile Descriptors[0m

Total: 2, limit: 65439
Sockets: 0, limit: 58893

[1mFree Disk Space[0m

Low free disk space watermark: 0.05 gb
Free disk space: 105.4149 gb

[1mTotals[0m

Connection count: 0
Queue count: 0
Virtual host count: 1

[1mListeners[0m

Interface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication
Interface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0
Interface: 0.0.0.0, port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0

C:\Program Files\rabbitmq_server-3.8.14\sbin>
```

çœ‹åˆ°ä»¥ä¸Šè¾“å‡ºï¼Œè¯´æ˜å·²ç»æ­£å¸¸å¯åŠ¨äº†

###### ç®¡ç†ç•Œé¢

> RabbitMQæ’ä»¶:https://www.rabbitmq.com/management.html



ä»æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€çœ‹ï¼š

```powershell
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmqctl status

[1mListeners[0m

Interface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication
Interface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0
Interface: 0.0.0.0, port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0
```

å¹¶æ²¡æœ‰å¼€å¯**ç®¡ç†ç•Œé¢æ’ä»¶ï¼ˆæ’ä»¶åï¼šrabbitmq_management ï¼Œç›‘å¬ç«¯å£ä¸ºï¼š15672ï¼‰**ï¼Œ

> é»˜è®¤çš„å¼€å¯çš„æ’ä»¶ï¼Œæ¯ä¸ªç‰ˆæœ¬å¯èƒ½ä¸ä¸€æ ·

æŸ¥çœ‹ä¸‹æ’ä»¶åˆ—è¡¨ï¼š

```powershell
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmq-plugins list
Listing plugins with pattern ".*" ...
 Configured: E = explicitly enabled; e = implicitly enabled
 | Status: * = running on rabbit@DESKTOP-E6NOF0N
 |/
[  ] rabbitmq_amqp1_0                  3.8.14
[  ] rabbitmq_auth_backend_cache       3.8.14
[  ] rabbitmq_auth_backend_http        3.8.14
[  ] rabbitmq_auth_backend_ldap        3.8.14
[  ] rabbitmq_auth_backend_oauth2      3.8.14
[  ] rabbitmq_auth_mechanism_ssl       3.8.14
[  ] rabbitmq_consistent_hash_exchange 3.8.14
[  ] rabbitmq_event_exchange           3.8.14
[  ] rabbitmq_federation               3.8.14
[  ] rabbitmq_federation_management    3.8.14
[  ] rabbitmq_jms_topic_exchange       3.8.14
[  ] rabbitmq_management               3.8.14
[  ] rabbitmq_management_agent         3.8.14
[  ] rabbitmq_mqtt                     3.8.14
[  ] rabbitmq_peer_discovery_aws       3.8.14
[  ] rabbitmq_peer_discovery_common    3.8.14
[  ] rabbitmq_peer_discovery_consul    3.8.14
[  ] rabbitmq_peer_discovery_etcd      3.8.14
[  ] rabbitmq_peer_discovery_k8s       3.8.14
[  ] rabbitmq_prometheus               3.8.14
[  ] rabbitmq_random_exchange          3.8.14
[  ] rabbitmq_recent_history_exchange  3.8.14
[  ] rabbitmq_sharding                 3.8.14
[  ] rabbitmq_shovel                   3.8.14
[  ] rabbitmq_shovel_management        3.8.14
[  ] rabbitmq_stomp                    3.8.14
[  ] rabbitmq_top                      3.8.14
[  ] rabbitmq_tracing                  3.8.14
[  ] rabbitmq_trust_store              3.8.14
[  ] rabbitmq_web_dispatch             3.8.14
[  ] rabbitmq_web_mqtt                 3.8.14
[  ] rabbitmq_web_mqtt_examples        3.8.14
[  ] rabbitmq_web_stomp                3.8.14
[  ] rabbitmq_web_stomp_examples       3.8.14
```

ç¡®å®æ²¡æœ‰å¯ç”¨ï¼Œç°åœ¨å¼€å§‹å¯ç”¨ï¼š

```powershell
#å¯ç”¨æ’ä»¶rabbitmq_management
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmq-plugins enable rabbitmq_management
Enabling plugins on node rabbit@DESKTOP-E6NOF0N:
rabbitmq_management
The following plugins have been configured:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch
Applying plugin configuration to rabbit@DESKTOP-E6NOF0N...
The following plugins have been enabled:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch

started 3 plugins.

# æŸ¥çœ‹æ˜¯å¦å¯ç”¨æ’ä»¶æˆåŠŸ
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmq-plugins list rabbitmq_management
Listing plugins with pattern "rabbitmq_management" ...
 Configured: E = explicitly enabled; e = implicitly enabled
 | Status: * = running on rabbit@DESKTOP-E6NOF0N
 |/
[E*] rabbitmq_management       3.8.14
[e*] rabbitmq_management_agent 3.8.14
```

å¯ç”¨æ’ä»¶æˆåŠŸåï¼Œè®¿é—®ï¼šhttp://localhost:15672/

![1617003649133](images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1617003649133.png)

æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨ï¼š

```shell
C:\Program Files\rabbitmq_server-3.8.14\sbin>rabbitmqctl list_users
Listing users ...
user    tags
guest   [administrator]

```

guestæ˜¯ç®¡ç†å‘˜è´¦å·ï¼Œå¯†ç æ˜¯ï¼šguestï¼Œç°åœ¨ä½¿ç”¨å…¶è¿›è¡Œç™»å½•

<img src="images/.Net%E6%9E%B6%E6%9E%84%E5%B8%88%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/1617003849181.png" alt="1617003849181" style="zoom:80%;" />

##### ç”¨æˆ·

```powershell
//åˆ›å»ºç”¨æˆ·testuserå¯†ç ä¸º123456 
rabbitmqctl  add_user testuser 123456   

//èµ‹äºˆtestuserè¯»å†™æ‰€æœ‰æ¶ˆæ¯é˜Ÿåˆ—çš„æƒé™
rabbitmqctl  set_permissions testuser ".*"  ".*"  ".*"    

//åˆ†é…ç”¨æˆ·ç»„(administrator)
rabbitmqctl  set_user_tags testuser administrator    
```



##### å¸è½½RabbitMQ å’ŒErlangç¯å¢ƒ

1   æ‰“å¼€Windowsæ§åˆ¶é¢æ¿ï¼ŒåŒå‡»â€œç¨‹åºå’ŒåŠŸèƒ½â€ã€‚
2   åœ¨å½“å‰å®‰è£…çš„ç¨‹åºåˆ—è¡¨ä¸­ï¼Œå³é”®å•å‡»RabbitMQ Serverï¼Œç„¶åå•å‡»â€œå¸è½½â€ã€‚
3   åœ¨å½“å‰å®‰è£…çš„ç¨‹åºåˆ—è¡¨ä¸­ï¼Œå³é”®å•å‡»â€œErlang OTPâ€ï¼Œç„¶åå•å‡»â€œå¸è½½â€ã€‚
4   æ‰“å¼€Windowsä»»åŠ¡ç®¡ç†å™¨ã€‚
5   åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­ï¼ŒæŸ¥æ‰¾è¿›ç¨‹epmd.exeã€‚ å¦‚æœæ­¤è¿›ç¨‹ä»åœ¨è¿è¡Œï¼Œè¯·å³é”®å•å‡»è¯¥è¿›ç¨‹ï¼Œç„¶åå•å‡»â€œç»“æŸè¿›ç¨‹â€ã€‚
6   åˆ é™¤RabbitMQå’ŒErlangçš„æ‰€æœ‰å®‰è£…ç›®å½•ã€‚
7   åˆ é™¤æ–‡ä»¶Cï¼š\ Windows \ .erlang.cookieï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚
8   åˆ é™¤ç”µè„‘æ‰¾é‚£ä¸ªæ‰€æœ‰çš„.erlang.cookieã€‚
9   åŒæ ·åœ¨Useræ–‡ä»¶å¤¹ä¸­ï¼Œè½¬åˆ°AppData \ Roaming \ RabbitMQã€‚åˆ é™¤RabbitMQ
10 æ‰“å¼€è¿è¡Œcmd->sc delete RabbitMQã€‚
11 æ‰“å¼€è¿è¡Œ->regedit æ‰¾åˆ°RabbitMQèŠ‚ç‚¹ï¼Œåˆ æ‰å³å¯



##### å…¶å®ƒ

 ä¸ºäº†æ–¹ä¾¿æŸ¥æ‰¾ ï¼Œ è®¾ç½®å¦‚ä¸‹ç¯å¢ƒå˜é‡ ï¼Œè¿™æ ·å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹åœ¨CMDè¿è¡Œ

**RABBITMQ_SERVER:** C:\Program Files\erl_rabbitmq_server-3.8.3(æ ¹ç›®å½•)
**Path** ï¼šï¼…RABBITMQ_SERVERï¼…\sbin